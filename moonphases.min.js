'use strict';KMG.DefaultDistanceLineConfig={lineLength:1E3,position:new THREE.Vector3(0,0,0),color:16777215,earthRadius:1};
KMG.DistanceLineObject=function(c,a){KMG.BaseObject.call(this);this.config=a=KMG.Util.extend(a,KMG.DefaultDistanceLineConfig);this.context=c;var f=0,e,b=new THREE.Geometry;b.vertices.push(new THREE.Vector3(-this.config.lineLength,0,0));b.vertices.push(new THREE.Vector3(this.config.lineLength,0,0));var h=new THREE.LineBasicMaterial({color:16777215,opacity:1,transparent:!1,fog:!1,lineWidth:2}),b=new THREE.Line(b,h);b.position=a.position;this.add(b);var g=new KMG.TexturedSphereObject(c,{texture:"earth",
radius:a.earthRadius,fog:!1,ambient:16777215,emissive:11184810});g.position=a.position.clone().add(new THREE.Vector3(-a.lineLength,0,0));this.add(g);b=new KMG.TexturedSphereObject(c,{texture:"Moon",radius:a.moonRadius,fog:!1,ambient:16777215,emissive:11184810});b.position=a.position.clone().add(new THREE.Vector3(a.lineLength,0,0));this.add(b);b=-a.lineLength+a.perigeeDistance/a.lineDistance*a.lineLength*2;h=new KMG.TexturedSphereObject(c,{texture:"Moon",radius:a.moonRadius,fog:!1,ambient:16777215,
emissive:11184810});h.position=a.position.clone().add(new THREE.Vector3(b,0,0));this.add(h);var d=new KMG.TexturedSphereObject(c,{texture:"Moon",radius:a.moonRadius,fog:!1,ambient:16777215,emissive:16777215});d.position=a.position.clone().add(new THREE.Vector3(a.lineLength,0,0));this.add(d);this.setShadowInteraction(!1);this.setEarthRotation=function(a){e=a};this.setMarkerPoint=function(a){f=a};this.setMoonPosition=function(a,d){};this.update=function(){var b=-a.lineLength+f/a.lineDistance*a.lineLength*
2;d.position=a.position.clone().add(new THREE.Vector3(b,0,0));e&&(g.rotation.setFromQuaternion(e),g.updateMatrix())}};KMG.DistanceLineObject.prototype=Object.create(KMG.BaseObject.prototype);KMG.DefaultMoonOrbitRingConfig={color:4281840,radius:260,ringOpacity:0.7,moonRadius:200};
KMG.MoonOrbitRingObject=function(c,a){KMG.BaseObject.call(this);this.config=a=KMG.Util.extend(a,KMG.DefaultMoonOrbitRingConfig);this.context=c;var f=this,e=0,b=0,h;this.setShadowInteraction(!1);this.add(function(){var d=new THREE.MeshBasicMaterial({ambient:4281840,color:4281840,shininess:150,specular:new THREE.Color(0),shading:THREE.NoShading,transparent:!0,side:THREE.DoubleSide,fog:!1,opacity:f.config.ringOpacity}),b=new THREE.RingGeometry2(a.perigeeDistance/a.apogeeDistance*a.radius,a.radius,180,
1,0,2*Math.PI);b.computeFaceNormals();d=new THREE.Mesh(b,d);d.position.z=-1E3*modelOptions.kmScalar;d.updateMatrix();return d}());var g=new KMG.TexturedSphereObject(c,{texture:"Moon",radius:a.moonRadius,fog:!1,ambient:16777215,emissive:14540253,color:0});this.add(g);this.setLunarRotation=function(a){h=a};this.setMoonPosition=function(a,g,f){e=a;b=g};this.update=function(){var d=new THREE.Vector3(e/a.apogeeDistance*a.radius,0,0);d.rotateZ(b*KMG.PI_BY_180);g.position=d;if(h){d=new THREE.Quaternion;
d.setFromAxisAngle(new THREE.Vector3(1,0,0),KMG.RAD_90);d.multiply(h);var f=new THREE.Quaternion;f.setFromAxisAngle(new THREE.Vector3(0,0,1),KMG.RAD_90);f.multiply(d);g.rotation.setFromQuaternion(f);g.updateMatrix()}}};KMG.MoonOrbitRingObject.prototype=Object.create(KMG.BaseObject.prototype);KMG.DefaultMoonOrbitTrackConfig={subdivisions:4,opacity:0.8,color:13421772,lineThickness:2.5,radius:260};
KMG.MoonOrbitTrack=function(c,a){KMG.BaseObject.call(this);this.config=a=KMG.Util.extend(a,KMG.DefaultMoonOrbitTrackConfig);this.context=c;for(var f=[],e=0;360>e;e++)f[e]=0;var b,h=0;this.reset=function(){for(var a=0;360>a;a++)f[a]=0};this.setNode=function(a,b){0<=a&&360>a&&(f[Math.round(a)]=b,h=a)};this.recreateTrack=function(){b&&this.remove(b);for(var g=new THREE.Geometry,d=[],e=Math.ceil(h-350),c=Math.round(h),l=e;l<=c;l++){var m=(l-e)/(c-270-e);1<m&&(m=1);var k=KMG.Math.clamp(l,360),k=a.radius*
(f[Math.round(k)]/a.apogeeDistance);0<k&&(k=new THREE.Vector3(k,0,0),k.rotateZ(l*KMG.PI_BY_180),g.vertices.push(k),d.push(m))}e=KMG.OrbitTrackShader;c=THREE.UniformsUtils.clone(e.uniforms);c.color.value=KMG.Util.rgbToArray(a.color);c.uThickness.value=a.lineThickness;d=new THREE.ShaderMaterial({uniforms:c,attributes:{alpha:{type:"f",value:d}},vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,transparent:!0});d.linewidth=a.lineThickness;b=new THREE.Line(g,d);b.position.z=-990*modelOptions.kmScalar;
this.add(b);this.setShadowInteraction(!1)};this.update=function(){}};KMG.MoonOrbitTrack.prototype=Object.create(KMG.BaseObject.prototype);
KMG.OrbitTrackShader={uniforms:THREE.UniformsUtils.merge([{uThickness:{type:"f",value:2},alpha:{type:"f",value:1},color:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:"attribute float alpha;\nvarying float vAlpha;\nuniform float uThickness;\nvoid main() {\n\tvAlpha = alpha;\n\tgl_PointSize = uThickness;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform vec3 color;\nvarying float vAlpha;\nvarying float uThickness;\nvoid main() {\n\tgl_FragColor = vec4( color, vAlpha );\n}"};
KMG.DefaultSunlightPositionIndicatorConfig={color:16776960,radius:200,indicatorSize:1};
KMG.SunlightPositionIndicator=function(c,a){KMG.BaseObject.call(this);this.config=a=KMG.Util.extend(a,KMG.DefaultSunlightPositionIndicatorConfig);this.context=c;this.add(function(){var c=new THREE.MeshBasicMaterial({ambient:a.color,color:a.color,shading:THREE.NoShading,transparent:!1,side:THREE.DoubleSide,fog:!1,opacity:1}),e=new THREE.RingGeometry2(0,a.indicatorSize,180,1,0,2*Math.PI);e.computeFaceNormals();c=new THREE.Mesh(e,c);c.position.z=a.radius;return c}());this.setShadowInteraction(!1);this.update=
function(){}};KMG.SunlightPositionIndicator.prototype=Object.create(KMG.BaseObject.prototype);
